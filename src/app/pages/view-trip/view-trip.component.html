<div class="view-page">
  <!-- Hero Section -->
  <div class="hero-section" [style.background-image]="'linear-gradient(rgba(0,0,0,0.4), rgba(0,0,0,0.4)), url(' + (trip?.image || 'https://images.unsplash.com/photo-1488646953014-85cb44e25828') + ')'">
    <div class="hero-overlay">
      <h1 class="hero-title">{{trip?.destination}}</h1>
      <p class="hero-subtitle">{{trip?.dates?.from | date:'dd/MM/yyyy'}} - {{trip?.dates?.to | date:'dd/MM/yyyy'}}</p>
    </div>
    <div class="header-actions">
      <button class="btn btn-light btn-home" routerLink="/">Accueil</button>
      <button class="btn btn-light btn-preview" (click)="goToEdit()">Modifier</button>
      <button class="btn btn-light btn-preview" (click)="exportToPDF()">Export PDF</button>
    </div>
  </div>

  <div class="view-container" id="trip-content">
    <!-- Info Card -->
    <div class="info-card">
      <div class="info-grid">
        <div class="info-item">
          <h4>Dates</h4>
          <p>{{trip?.dates?.from | date:'dd/MM/yyyy'}} - {{trip?.dates?.to | date:'dd/MM/yyyy'}}</p>
        </div>
        <div class="info-item">
          <h4>Participants</h4>
          <p>{{trip?.participants?.join(', ')}}</p>
        </div>
        <div class="info-item">
          <h4>Objectif</h4>
          <p>{{trip?.objective}}</p>
        </div>
        <div class="info-item">
          <h4>Statut</h4>
          <span class="status-badge">{{getStatusLabel(trip?.status || 'planned')}}</span>
        </div>
      </div>
    </div>

    <!-- Transport -->
    <div class="section-card" *ngIf="trip?.transport && trip?.transport.length > 0">
      <h3 class="section-title">Transport</h3>
      <table class="modern-table">
        <thead>
          <tr>
            <th>Personne</th>
            <th>Trajet</th>
            <th>Type</th>
            <th>Horaires</th>
            <th class="text-end">Coût</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let transport of trip?.transport">
            <td><strong>{{transport.personne}}</strong></td>
            <td>{{transport.trajet}}</td>
            <td><span class="badge bg-light text-dark">{{transport.type}}</span></td>
            <td>{{transport.horaires}}</td>
            <td class="text-end"><strong>{{transport.cout}}€</strong></td>
          </tr>
        </tbody>
        <tfoot>
          <tr>
            <td colspan="4"><strong>Total Transport</strong></td>
            <td class="text-end"><strong>{{getTotalTransportCost()}}€</strong></td>
          </tr>
        </tfoot>
      </table>
    </div>

    <!-- Hébergement -->
    <div class="section-card" *ngIf="trip?.hebergement?.nom">
      <h3 class="section-title">Hébergement</h3>
      <div class="row">
        <div class="col-md-8">
          <h5>{{trip?.hebergement?.nom}}</h5>
          <p class="text-muted mb-2">{{trip?.hebergement?.adresse}}</p>
          <p class="mb-2">
            <span class="badge bg-primary">{{trip?.hebergement?.type}}</span>
          </p>
          <p *ngIf="trip?.hebergement?.note" class="text-muted">
            <em>{{trip?.hebergement?.note}}</em>
          </p>
        </div>
        <div class="col-md-4 text-end">
          <div class="h4 text-success">{{trip?.hebergement?.prixTotal}}€</div>
          <small class="text-muted">Prix total</small>
        </div>
      </div>
    </div>

    <!-- Activités -->
    <div class="section-card" *ngIf="trip?.activites && trip?.activites.length > 0">
      <h3 class="section-title">Activités & Visites</h3>
      <div class="activity-grid">
        <div class="activity-card" *ngFor="let activite of trip?.activites">
          <h6 class="activity-title">{{activite.nom}}</h6>
          <p class="text-muted mb-2">{{activite.description}}</p>
          <a *ngIf="activite.lien" [href]="activite.lien" target="_blank" class="btn btn-outline-primary btn-sm">
            Plus d'infos
          </a>
        </div>
      </div>
    </div>

    <!-- Checklist -->
    <div class="section-card" *ngIf="trip?.checklist && trip?.checklist.length > 0">
      <h3 class="section-title">Points de vérification</h3>
      <div class="checklist-grid">
        <div class="checklist-item" *ngFor="let item of trip?.checklist" [class.completed]="item.checked">
          <input type="checkbox" [checked]="item.checked" disabled class="form-check-input me-3">
          <span [class.text-decoration-line-through]="item.checked" [class.text-muted]="item.checked">
            {{item.text}}
          </span>
        </div>
      </div>
    </div>

    <!-- Résumé des coûts -->
    <div class="cost-summary">
      <h4 class="cost-title">Résumé financier</h4>
      <div class="cost-item">
        <span>Transport :</span>
        <strong>{{getTotalTransportCost()}}€</strong>
      </div>
      <div class="cost-item">
        <span>Hébergement :</span>
        <strong>{{trip?.hebergement?.prixTotal || 0}}€</strong>
      </div>
      <div class="cost-total">
        <span>Total :</span>
        <span>{{getTotalTransportCost() + (trip?.hebergement?.prixTotal || 0)}}€</span>
      </div>
    </div>

    <!-- Status Actions -->
    <div class="status-actions">
      <button class="btn-status btn-validate" (click)="updateStatus('validated')">Valider</button>
      <button class="btn-status btn-complete" (click)="updateStatus('completed')">Terminer</button>
      <button class="btn-status btn-cancel" (click)="updateStatus('cancelled')">Annuler</button>
    </div>
  </div>
</div>